(()=>{"use strict";const e=function(e,t){var s,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];try{s=new CustomEvent(t,{bubbles:r,cancelable:n,detail:o})}catch(e){(s=document.createEvent("CustomEvent")).initCustomEvent(t,r,n,o)}e.dispatchEvent(s)};async function t(t,s){const o=t.querySelector(".smf-focus-point"),r=t.querySelector(".smf-form"),n=t.querySelector(".smf-action"),a=new FormData(t),c=n.querySelector('[data-clicked="true"]'),l=c||n.querySelector('[type="submit"]'),i=l?l.querySelector(".smf-sending"):void 0;i&&i.setAttribute("aria-hidden","false"),c&&c.removeAttribute("data-clicked");const m={status:"init",inputs:[].slice.call(t.querySelectorAll("input[name]:not([disabled]), textarea[name]:not([disabled]), select[name]:not([disabled])")).map((e=>{let t;return"checkbox"===e.type||"radio"===e.type?e.checked&&(t=e.value):t=e.value,void 0!==t&&{name:e.getAttribute("name"),value:t}})).filter((e=>e)),formData:a},d=e=>{r.innerHTML=e},f=e=>{n.innerHTML=e},u=()=>{o&&window.scrollTo(0,window.pageYOffset+o.getBoundingClientRect().top)},y=(s=null)=>{t.setAttribute("data-screen","systemerror");const o=document.createElement("div");o.classList.add("smf-system-error-content");const r=t.querySelector(".smf-system-error-content-ready");if(o.textContent=r.textContent,s){const e=document.createElement("br"),t=document.createElement("span");t.classList.add("smf-system-error-status-text"),t.textContent=`(status: ${s})`,o.appendChild(e),o.appendChild(t)}d(o.outerHTML),f(""),u(),m.status="systemerror",e(t,"smf.systemerror",m)};e(t,"smf.beforesubmit",m);try{const o=await fetch(snowmonkeyforms.view_json_url,s);if(!o.ok)throw new Error(o.statusText);{const s=await o.json();(s=>{i&&i.setAttribute("aria-hidden","true");const o=s?.method;if(o){if(t.setAttribute("data-screen",o),f(s.action),"input"!==o){if([].slice.call(t.querySelectorAll(".smf-placeholder")).forEach((e=>{e.innerHTML=""})),(e=>"back"===e||"invalid"===e||"confirm"===e)(o)){(e=>{for(const s in e){const o=e[s];Array.isArray(o)?t.querySelectorAll(`.smf-placeholder[data-name="${s}"]`).forEach(((e,t)=>{e.innerHTML=o[t]})):t.querySelector(`.smf-placeholder[data-name="${s}"]`).innerHTML=o}})(s.controls);const e=[].slice.call(t.querySelectorAll(".smf-error-messages"));0<e.length?(e=>{if(0<e.length){const t=((e,t)=>{for(let s=e;s;s=s.parentElement)if(s.classList.contains(t))return s})(e[0],"smf-placeholder"),s=!!t&&t.querySelector("input, select, textarea, button, .smf-file-control");s&&s.focus()}})(e):u()}else(e=>"complete"===e||"systemerror"===e)(o)?(d(s.message),u(),f(s.action)):(d(""),f(""));switch(m.status=o,m.status){case"back":e(t,"smf.back",m);break;case"confirm":e(t,"smf.confirm",m);break;case"complete":e(t,"smf.complete",m);break;case"invalid":e(t,"smf.invalid",m);break;case"systemerror":e(t,"smf.systemerror",m)}e(t,"smf.submit",m)}}else y()})(JSON.parse(s))}}catch(e){y(e)}}document.addEventListener("change",(e=>{const t=e.target;if(t.classList.contains("smf-file-control__control")){const e=t.closest(".smf-file-control"),s=e.querySelector(".smf-file-control__filename--has-file"),o=t.files;if(0<o.length&&s){const t=o[0];void 0!==t.name&&(s.textContent=t.name,e.classList.add("smf-file-control--set"))}}}),!1),document.addEventListener("click",(e=>{const t=e.target;if(t.classList.contains("smf-file-control__clear")){const e=t.closest(".smf-file-control");e.classList.remove("smf-file-control--set"),e.classList.remove("smf-file-control--uploaded"),e.querySelector(".smf-file-control__control").value="";const s=t.closest(".smf-placeholder").querySelector(".smf-file-control__value");s&&s.remove()}}),!1);const s=(e,t)=>{for(let s=e;s;s=s.parentElement)if(s.classList.contains(t))return s};document.addEventListener("click",(e=>{const t=e.target;if(t.getAttribute("data-action")&&t.setAttribute("data-clicked","true"),"back"===t.getAttribute("data-action")){const e=s(t,"smf-action");if(e){const t=e.querySelector('[type="hidden"][name="snow-monkey-forms-meta[method]"]');t&&t.setAttribute("value","back")}}}),!1),[].slice.call(document.querySelectorAll(".snow-monkey-form")).forEach((e=>{e.addEventListener("submit",(s=>{s.preventDefault(),function(e){t(e,{method:"POST",body:new FormData(e),headers:{"X-WP-Nonce":snowmonkeyforms?.nonce}})}(e)})),function(e){var s;t(e,{method:"GET",headers:{"x-smf-formid":null!==(s=e.querySelector('[name="snow-monkey-forms-meta[formid]"]')?.value)&&void 0!==s&&s}})}(e)})),["change","keyup"].forEach((e=>{document.addEventListener(e,(e=>{const t=e.target;if("1"===t.getAttribute("data-invalid")){t.removeAttribute("data-invalid"),[].slice.call(t.querySelectorAll('[data-invalid="1"]')).forEach((e=>e.removeAttribute("data-invalid")));const e=s(t,"smf-placeholder");if(e){const t=e.querySelector(".smf-error-messages");t&&t.parentNode.removeChild(t)}}}),!1)}))})();